import{j as e,r as i,S as R,L as $}from"./app-yxEi3xJe.js";import{B as d}from"./badge-D-KVUJFH.js";import{U as K,E as q}from"./modal-CJuobXsJ.js";import{T as H,d as A,b as l,e as t,a as F,c as z}from"./table-DtoZaXGU.js";import{B as f}from"./app-logo-icon-CXNx6eOd.js";import{D as Q,a as X,b as Z,c as ee,d as ae,e as p,A as se}from"./app-layout-BmWLcPuv.js";import{S as M,a as v,b as C,c as G,d as B}from"./select-BnEmntSq.js";import{u as te,f as E,g as ne}from"./index-CgUmL9e7.js";import"./index-BcpDV_59.js";function ie({open:r,onClose:_,payroll:s}){return s?e.jsx(K,{open:r,onClose:_,title:"Detail Data Gaji",children:e.jsx(H,{children:e.jsxs(A,{children:[e.jsxs(l,{children:[e.jsx(t,{children:"Nama Karyawan"}),e.jsx(t,{children:":"}),e.jsx(t,{children:s.user.name})]}),e.jsxs(l,{children:[e.jsx(t,{children:"Bulan & Tahun"}),e.jsx(t,{children:":"}),e.jsxs(t,{children:[new Date(s.period_year,s.period_month-1).toLocaleString("id-ID",{month:"long"}),", ",s.period_year]})]}),e.jsxs(l,{children:[e.jsx(t,{children:"Total Gaji Pokok"}),e.jsx(t,{children:":"}),e.jsxs(t,{className:"text-sm/7",children:[e.jsx("span",{className:"text-red-500",children:"("}),"Total Kehadiran",e.jsx("span",{className:"text-yellow-500",children:" + "}),"Jatah Libur",e.jsx("span",{className:"text-red-500",children:")"}),e.jsx("span",{className:"text-yellow-500",children:" × "}),"Gaji Pokok Harian",e.jsx("br",{}),e.jsx("span",{className:"text-red-500",children:"("}),s.total_attendance_days," hari",e.jsx("span",{className:"text-yellow-500",children:" + "}),s.paid_holidays," hari",e.jsx("span",{className:"text-red-500",children:")"}),e.jsx("span",{className:"text-yellow-500",children:" × "}),"Rp ",s.basic_salary.toLocaleString("id-ID"),e.jsx("br",{}),e.jsxs("span",{className:"text-blue-500",children:["Rp ",s.total_basic_salary.toLocaleString("id-ID")]})]})]}),e.jsxs(l,{children:[e.jsx(t,{children:"Total Gaji Lembur"}),e.jsx(t,{children:":"}),e.jsxs(t,{className:"text-sm/7",children:["Total Jam Lembur",e.jsx("span",{className:"text-yellow-500",children:" × "}),"Uang Lembur Per Jam",e.jsx("br",{}),s.total_overtime_hours," jam",e.jsx("span",{className:"text-yellow-500",children:" × "}),"Rp ",s.hourly_overtime_pay.toLocaleString("id-ID"),e.jsx("br",{}),e.jsxs("span",{className:"text-blue-500",children:["Rp ",s.total_overtime_pay.toLocaleString("id-ID")]})]})]}),e.jsxs(l,{children:[e.jsx(t,{children:"Total Bonus Tepat Waktu"}),e.jsx(t,{children:":"}),e.jsxs(t,{className:"text-sm/7",children:["Total Tepat Waktu",e.jsx("span",{className:"text-yellow-500",children:" × "}),"Bonus Tepat Waktu Harian",e.jsx("br",{}),s.total_punctual_days," hari",e.jsx("span",{className:"text-yellow-500",children:" × "}),"Rp ",s.bonus_amount.toLocaleString("id-ID"),e.jsx("br",{}),e.jsxs("span",{className:"text-blue-500",children:["Rp ",s.total_bonus.toLocaleString("id-ID")]})]})]}),e.jsxs(l,{children:[e.jsx(t,{children:"Total Potongan Telat"}),e.jsx(t,{children:":"}),e.jsxs(t,{className:"text-sm/7",children:["Total Telat",e.jsx("span",{className:"text-yellow-500",children:" × "}),"Potongan Telat Harian",e.jsx("br",{}),s.total_late_days," hari",e.jsx("span",{className:"text-yellow-500",children:" × "}),"Rp ",s.penalty_amount.toLocaleString("id-ID"),e.jsx("br",{}),e.jsxs("span",{className:"text-blue-500",children:["Rp ",s.total_penalty.toLocaleString("id-ID")]})]})]}),e.jsxs(l,{children:[e.jsx(t,{children:"Total Gaji Kotor"}),e.jsx(t,{children:":"}),e.jsxs(t,{children:["Total Gaji Pokok",e.jsx("span",{className:"text-yellow-500",children:" + "}),"Total Gaji Lembur",e.jsx("span",{className:"text-yellow-500",children:" + "}),"Tunjangan Transportasi",e.jsx("span",{className:"text-yellow-500",children:" + "}),"Total Bonus Tepat Waktu",e.jsx("span",{className:"text-yellow-500",children:" - "}),"Total Potongan Telat",e.jsx("br",{}),"Rp ",s.total_basic_salary.toLocaleString("id-ID"),e.jsx("span",{className:"text-yellow-500",children:" + "}),"Rp ",s.total_overtime_pay.toLocaleString("id-ID"),e.jsx("span",{className:"text-yellow-500",children:" + "}),"Rp ",s.transportation_allowance.toLocaleString("id-ID"),e.jsx("span",{className:"text-yellow-500",children:" + "}),"Rp ",s.total_bonus.toLocaleString("id-ID"),e.jsx("span",{className:"text-yellow-500",children:" - "}),"Rp ",s.total_penalty.toLocaleString("id-ID"),e.jsx("br",{}),e.jsxs("span",{className:"text-blue-500",children:["Rp ",s.gross_salary.toLocaleString("id-ID")]})]})]}),e.jsxs(l,{children:[e.jsx(t,{children:"Total Potongan"}),e.jsx(t,{children:":"}),e.jsxs(t,{className:"text-sm/7",children:["BPJS Kesehatan",e.jsx("span",{className:"text-yellow-500",children:" + "}),"BPJS Ketenagakerjaan",e.jsx("span",{className:"text-yellow-500",children:" + "}),"Pajak Penghasilan",e.jsx("br",{}),s.bpjs_health_percent," %",e.jsx("span",{className:"text-yellow-500",children:" + "}),s.bpjs_employment_percent," %",e.jsx("span",{className:"text-yellow-500",children:" + "}),s.income_tax_percent," %",e.jsx("br",{}),s.total_deduction_percent," %",e.jsx("br",{}),e.jsxs("span",{className:"text-blue-500",children:["Rp ",s.total_deductions.toLocaleString("id-ID")]})]})]}),e.jsxs(l,{children:[e.jsx(t,{children:"Total Gaji Bersih"}),e.jsx(t,{children:":"}),e.jsxs(t,{children:["Total Gaji Kotor",e.jsx("span",{className:"text-yellow-500",children:" - "}),"Total Potongan Dalam Bentuk Rupiah",e.jsx("br",{}),"Rp ",s.gross_salary.toLocaleString("id-ID"),e.jsx("span",{className:"text-yellow-500",children:" - "}),"Rp ",s.total_deductions.toLocaleString("id-ID"),e.jsx("br",{}),e.jsxs("span",{className:"text-blue-500",children:["Rp ",s.net_salary.toLocaleString("id-ID")]})]})]}),e.jsxs(l,{children:[e.jsx(t,{children:"Status"}),e.jsx(t,{children:":"}),e.jsx(t,{children:s.salary_status==="unpaid"?e.jsx(d,{className:"bg-amber-500/10 p-1.5 text-amber-500",children:"Belum Dibayar"}):s.salary_status==="paid_cash"?e.jsx(d,{className:"bg-emerald-500/10 p-1.5 text-emerald-500",children:"Sudah Dibayar Tunai"}):s.salary_status==="paid_transfer"?e.jsx(d,{className:"bg-emerald-500/10 p-1.5 text-emerald-500",children:"Sudah Dibayar Transfer"}):e.jsx(d,{className:"text-natural-500 bg-neutral-500/10 p-1.5",children:"Belum Dihitung"})})]}),e.jsxs(l,{children:[e.jsx(t,{children:"Konfirmasi Gaji"}),e.jsx(t,{children:":"}),e.jsx(t,{children:s.confirmation_status==="pending_confirmation"?e.jsx(d,{className:"bg-amber-500/10 p-1.5 text-amber-500",children:"Menunggu Konfirmasi"}):s.confirmation_status==="received"?e.jsx(d,{className:"bg-emerald-500/10 p-1.5 text-emerald-500",children:"Gaji Sudah Diterima"}):e.jsx("span",{children:"-"})})]})]})})}):null}const le={uncalculated:["Belum Dihitung","p-1.5 text-natural-500 bg-neutral-500/10"],unpaid:["Belum Dibayar","p-1.5 text-amber-500 bg-amber-500/10"],paid_transfer:["Sudah Dibayar Transfer","p-1.5 text-emerald-500 bg-emerald-500/10"],paid_cash:["Sudah Dibayar Tunai","p-1.5 text-emerald-500 bg-emerald-500/10"]},re={blank:["-","border-0 p-0 bg-transparent dark:text-white text-black"],pending_confirmation:["Menunggu Konfirmasi","p-1.5 text-amber-500 bg-amber-500/10"],received:["Gaji Sudah Diterima","p-1.5 text-emerald-500 bg-emerald-500/10"]};function _e({payrolls:r}){const[_,s]=i.useState(!1),[Y,J]=i.useState(null),[O,g]=i.useState(!1),[b,V]=i.useState(null),S=i.useMemo(()=>{const a=new Date;let n=a.getMonth()+1,c=a.getFullYear();if(!r.some(x=>x.period_month===n&&x.period_year===c)){let x=n-1,D=c;if(x<1&&(x=12,D=c-1),r.some(h=>h.period_month===x&&h.period_year===D))n=x,c=D;else{const h=[...r].sort((L,k)=>{const I=k.period_year-L.period_year;return I!==0?I:k.period_month-L.period_month});h.length>0&&(n=h[0].period_month,c=h[0].period_year)}}return{month:n,year:c}},[r]),[j,N]=i.useState(S.month),[o,T]=i.useState(S.year),m=i.useMemo(()=>[...new Set(r.map(a=>a.period_year))].sort((a,n)=>n-a),[r]),u=i.useMemo(()=>[...new Set(r.filter(a=>a.period_year===o).map(a=>a.period_month))].sort((a,n)=>a-n),[r,o]);i.useEffect(()=>{u.length>0&&!u.includes(j)&&N(Math.max(...u))},[u,j]),i.useEffect(()=>{m.length>0&&!m.includes(o)&&T(Math.max(...m))},[m,o]);const W=i.useMemo(()=>r.filter(a=>a.period_month===j&&a.period_year===o),[r,j,o]),U=i.useMemo(()=>[{header:"Nama",cell:({row:a})=>a.original.user.name},{header:"Gaji Bersih",cell:({row:a})=>a.original.net_salary?e.jsxs("span",{className:"text-nowrap",children:["Rp ",a.original.net_salary.toLocaleString("id-ID")]}):"-"},{header:"Status Gaji",cell:({row:a})=>{const[n,c]=le[a.original.salary_status];return e.jsx(d,{className:c,children:n})}},{header:"Konfirmasi Gaji",cell:({row:a})=>{const[n,c]=re[a.original.confirmation_status];return e.jsx(d,{className:c,children:n})}},{header:"Aksi",cell:({row:a})=>e.jsxs(Q,{children:[e.jsx(X,{asChild:!0,children:e.jsx(f,{variant:"ghost",className:"h-8 w-8 p-0",children:e.jsx(q,{})})}),e.jsxs(Z,{align:"end",children:[e.jsx(ee,{children:"Aksi"}),e.jsx(ae,{}),e.jsx(p,{onClick:()=>P(a.original.id),hidden:a.original.salary_status!=="uncalculated",children:"Hitung Gaji"}),e.jsx(p,{onClick:()=>P(a.original.id),hidden:a.original.salary_status!=="unpaid",children:"Perbarui Hitung Gaji"}),e.jsx(p,{onClick:()=>{J(a.original),s(!0)},hidden:a.original.salary_status==="uncalculated",children:"Lihat Detail Gaji"}),e.jsx(p,{onClick:()=>{V(a.original.id),g(!0)},hidden:a.original.salary_status!=="unpaid",children:"Tandai Gaji Sudah Dibayar"}),e.jsx(p,{onClick:()=>window.open(`/penggajian/pdf/${a.original.id}`,"_blank"),hidden:a.original.confirmation_status!=="received",children:"Slip Gaji"})]})]})}],[]),y=te({data:W,columns:U,getCoreRowModel:ne()}),w=(a,n)=>{R.patch(`/perhitungan-penggajian/paid/${a}`,{salary_status:n,confirmation_status:"pending_confirmation"})},P=a=>{R.patch(`/perhitungan-penggajian/calculate/${a}`)};return e.jsxs(se,{breadcrumbs:[{title:"Perhitungan Penggajian",href:"/"}],children:[e.jsx($,{title:"Perhitungan Penggajian"}),e.jsxs("div",{className:"overflow-x-auto p-4",children:[e.jsxs("div",{className:"mb-4 flex gap-4",children:[e.jsx("div",{className:"w-[200px]",children:e.jsxs(M,{value:j.toString(),onValueChange:a=>N(Number(a)),children:[e.jsx(v,{children:e.jsx(C,{placeholder:"Pilih Bulan"})}),e.jsx(G,{children:u.map(a=>e.jsx(B,{value:a.toString(),children:new Date(2e3,a-1).toLocaleDateString("id-ID",{month:"long"})},a))})]})}),e.jsx("div",{className:"w-[200px]",children:e.jsxs(M,{value:o.toString(),onValueChange:a=>T(parseInt(a)),children:[e.jsx(v,{children:e.jsx(C,{placeholder:"Pilih Tahun"})}),e.jsx(G,{children:m.map(a=>e.jsx(B,{value:a.toString(),children:a},a))})]})})]}),e.jsx("div",{className:"rounded-md border",children:e.jsxs(H,{children:[e.jsx(F,{children:y.getHeaderGroups().map(a=>e.jsx(l,{children:a.headers.map(n=>e.jsx(z,{children:E(n.column.columnDef.header,n.getContext())},n.id))},a.id))}),e.jsx(A,{children:y.getRowModel().rows.map(a=>e.jsx(l,{children:a.getVisibleCells().map(n=>e.jsx(t,{children:E(n.column.columnDef.cell,n.getContext())},n.id))},a.id))})]})})]}),e.jsx(K,{open:O,onClose:()=>g(!1),title:"Pilih Pembayaran Gaji",children:e.jsxs("div",{className:"grid gap-3 pt-4 sm:grid-cols-2 sm:px-25",children:[e.jsx(f,{variant:"secondary",onClick:()=>{b&&w(b,"paid_transfer"),g(!1)},children:"Sudah Dibayar Transfer"}),e.jsx(f,{variant:"secondary",onClick:()=>{b&&w(b,"paid_cash"),g(!1)},children:"Sudah Dibayar Tunai"})]})}),e.jsx(ie,{open:_,onClose:()=>s(!1),payroll:Y})]})}export{_e as default};
