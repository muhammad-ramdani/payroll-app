import{r as o,S as N,j as a,L as y}from"./app-yxEi3xJe.js";import{A as I,a as M,b as R,c as D,d as L,e as v,f as w}from"./alert-dialog-BBZ7bok1.js";import{B as O}from"./badge-D-KVUJFH.js";import{c as E,B as g}from"./app-logo-icon-CXNx6eOd.js";import{A as V}from"./app-layout-BmWLcPuv.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=[["path",{d:"M12.338 21.994A10 10 0 1 1 21.925 13.227",key:"1i7shu"}],["path",{d:"M12 6v6l2 1",key:"19cm8n"}],["path",{d:"m14 18 4 4 4-4",key:"1waygx"}],["path",{d:"M18 14v8",key:"irew45"}]],C=E("ClockArrowDown",P);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=[["path",{d:"M13.228 21.925A10 10 0 1 1 21.994 12.338",key:"1fzlyi"}],["path",{d:"M12 6v6l1.562.781",key:"1ujuk9"}],["path",{d:"m14 18 4-4 4 4",key:"ftkppy"}],["path",{d:"M18 22v-8",key:"su0gjh"}]],$=E("ClockArrowUp",U);function B(n,s,t,c){const k=n*Math.PI/180,d=t*Math.PI/180,u=(t-n)*Math.PI/180,r=(c-s)*Math.PI/180,m=Math.sin(u/2)*Math.sin(u/2)+Math.cos(k)*Math.cos(d)*Math.sin(r/2)*Math.sin(r/2);return 6371e3*(2*Math.atan2(Math.sqrt(m),Math.sqrt(1-m)))}async function K(){return new Promise((n,s)=>{navigator.geolocation||s(new Error("Geolocation is not supported by your browser")),navigator.geolocation.getCurrentPosition(t=>{n({latitude:t.coords.latitude,longitude:t.coords.longitude})},t=>{s(t)},{enableHighAccuracy:!0,timeout:5e3,maximumAge:0})})}const j={BASE_URL:"/build/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_APP_NAME:"Presensi dan Penggajian",VITE_STORE_1_LAT:"-7.4818420819310365",VITE_STORE_1_LNG:"108.59916094129481",VITE_STORE_1_NAME:"GS Elektronik Cikohkol",VITE_STORE_1_RADIUS:"100",VITE_STORE_2_LAT:"-7.475940041172835",VITE_STORE_2_LNG:"108.59851818750803",VITE_STORE_2_NAME:"GS Elektronik Sukajadi",VITE_STORE_2_RADIUS:"100",VITE_STORE_3_LAT:"-7.433986364994609",VITE_STORE_3_LNG:"109.23912054036985",VITE_STORE_3_NAME:"Kost Ramdani",VITE_STORE_3_RADIUS:"100",VITE_STORE_4_LAT:"-7.434787674381042",VITE_STORE_4_LNG:"109.25211064225263",VITE_STORE_4_NAME:"TUP",VITE_STORE_4_RADIUS:"100"},G=(n,s,t=Date.now())=>{if(!n)return"-";const c=_=>{const[h,x,e="0"]=_.split(":"),l=new Date(t);return l.setHours(+h,+x,+e),l},p=c(n),k=s?c(s):new Date,d=Math.max(0,k.getTime()-p.getTime()),u=String(Math.floor(d/36e5)).padStart(2,"0"),r=String(Math.floor(d%36e5/6e4)).padStart(2,"0"),m=String(Math.floor(d%6e4/1e3)).padStart(2,"0");return`${u}:${r}:${m}`},J=({status:n})=>{const[s,t]={not_started:["Belum Hadir","text-amber-500 bg-amber-500/10"],working:["Sedang Bekerja","text-emerald-500 bg-emerald-500/10"],finished:["Sudah Pulang","text-blue-500 bg-blue-500/10"],leave:["Libur Cuti","text-rose-500 bg-rose-500/10"],sick:["Libur Sakit","text-fuchsia-500 bg-fuchsia-500/10"]}[n];return a.jsx(O,{className:t,children:s})};function X({attendances:n,attendanceRules:s,bonusPenaltySettings:t}){const[c,p]=o.useState(n),[k,d]=o.useState(Date.now()),[u,r]=o.useState(!1),[m,_]=o.useState([]);o.useEffect(()=>{const e=setInterval(()=>d(Date.now()),1e3);return()=>clearInterval(e)},[]),o.useEffect(()=>{p(n)},[n]);const h=o.useCallback((e,l)=>{N.patch(`/presensi/${e}`,{action:l})},[]),x=o.useCallback(async(e,l)=>{const{latitude:T,longitude:A}=await K(),b=[];for(let i=1;i<=100;i++){const f=j[`VITE_STORE_${i}_LAT`],S=j[`VITE_STORE_${i}_LNG`];if(!f||!S)break;b.push({name:j[`VITE_STORE_${i}_NAME`]||`Store ${i}`,lat:parseFloat(f),lng:parseFloat(S),radius:parseFloat(j[`VITE_STORE_${i}_RADIUS`])||100})}if(!b.find(i=>B(T,A,i.lat,i.lng)<=i.radius)){_(b),r(!0);return}return h(l,e)},[h]);return a.jsxs(V,{breadcrumbs:[{title:"Presensi",href:"/"}],children:[a.jsx(y,{title:"Presensi"}),c.length===0?a.jsx("div",{className:"flex h-9/10 items-center justify-center",children:a.jsx("p",{className:"text-muted-foreground text-sm",children:"Presensi baru akan tersedia pukul 06:30 pagi."})}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"mx-4 mt-16 flex justify-center",children:c.map(e=>a.jsxs("div",{className:"space-y-8 text-center",children:[a.jsx("p",{className:"text-sm",children:new Date(e.date).toLocaleDateString("id-ID",{dateStyle:"full"})}),a.jsxs("div",{className:"text-sm",children:["Shift kamu hari ini",a.jsxs("span",{className:`${e.shift_type==="Pagi"?"text-blue-500":"text-yellow-500"}`,children:[" ",e.shift_type]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("p",{className:"text-muted-foreground text-sm",children:"Jam Masuk"}),e.status==="leave"||e.status==="sick"?a.jsx("p",{className:"text-sm font-medium",children:"-"}):e.clock_in?a.jsx("p",{className:"text-sm font-medium",children:e.clock_in}):a.jsxs(g,{variant:"secondary",onClick:()=>x("clock_in",e.id),children:[a.jsx(C,{})," Masuk Kerja"]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("p",{className:"text-muted-foreground text-sm",children:"Jam Pulang"}),e.status==="leave"||e.status==="sick"?a.jsx("p",{className:"text-sm font-medium",children:"-"}):e.clock_out?a.jsx("p",{className:"text-sm font-medium",children:e.clock_out}):a.jsxs(g,{variant:"secondary",disabled:!e.clock_in,onClick:()=>x("clock_out",e.id),children:[a.jsx($,{})," Pulang Kerja"]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("p",{className:"text-muted-foreground text-sm",children:"Waktu Kerja"}),a.jsx("p",{className:"text-sm font-medium",children:G(e.clock_in,e.clock_out,k)})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("p",{className:"text-muted-foreground text-sm",children:"Status Kehadiran"}),a.jsx(J,{status:e.status})]}),e.status==="not_started"&&a.jsxs("div",{className:"space-y-4 pt-8",children:[a.jsx("p",{className:"text-muted-foreground text-sm",children:"Tombol Libur Kerja"}),a.jsxs("div",{className:"space-x-4",children:[a.jsx(g,{className:"border border-fuchsia-500 bg-transparent text-fuchsia-500 hover:bg-fuchsia-500/15",onClick:()=>h(e.id,"sick"),children:"Libur Sakit"}),a.jsx(g,{className:"border border-rose-500 bg-transparent text-rose-500 hover:bg-rose-500/15",onClick:()=>h(e.id,"leave"),children:"Libur Cuti"})]})]})]},e.id))}),a.jsxs("div",{className:"text-muted-foreground mx-4 mt-32 mb-4 space-y-2",children:[a.jsx("p",{className:"text-sm font-semibold",children:"Catatan:"}),a.jsxs("ul",{className:"ml-5 list-disc space-y-1 text-sm",children:[a.jsx("li",{children:'Presensi Kehadiran "Jam Masuk" dan "Jam Pulang" hanya bisa dilakukan di toko saja, kecuali "Tombol Libur Kerja" bisa dilakukan dimana saja.'}),a.jsx("li",{children:'Jika sampai jam 14:00 tidak menekan tombol "Jam Masuk", maka status kehadiran akan otomatis menjadi "Tidak Masuk".'}),a.jsxs("li",{children:["Bagi karyawan shift Pagi, jika masuk sebelum pukul ",s[1].punctual_end,", akan mendapatkan bonus sebesar Rp"," ",t.bonus_amount.toLocaleString("id-ID")," per hari. Sebaliknya, jika masuk setelah pukul ",s[1].late_threshold,", akan dikenakan potongan gaji sebesar Rp ",t.penalty_amount.toLocaleString("id-ID")," per hari."]}),a.jsxs("li",{children:["Bagi karyawan shift Siang, jika masuk sebelum pukul ",s[2].punctual_end,", akan mendapatkan bonus sebesar Rp"," ",t.bonus_amount.toLocaleString("id-ID")," per hari. Sebaliknya, jika masuk setelah pukul ",s[2].late_threshold,", akan dikenakan potongan gaji sebesar Rp ",t.penalty_amount.toLocaleString("id-ID")," per hari."]}),a.jsx("li",{children:"Waktu kerja yang melebihi 8 jam akan dianggap sebagai kerja lembur dan akan diberikan Uang lembur Per Jam."})]})]})]}),a.jsx(I,{open:u,onOpenChange:r,children:a.jsxs(M,{children:[a.jsxs(R,{children:[a.jsx(D,{children:"Lokasi Tidak Valid"}),a.jsxs(L,{children:["Anda harus berada di salah satu lokasi berikut:",m.map((e,l)=>a.jsxs("li",{children:[e.name," (radius ",e.radius,"m)"]},l))]})]}),a.jsx(v,{children:a.jsx(w,{onClick:()=>r(!1),children:"OK"})})]})})]})}export{X as default};
