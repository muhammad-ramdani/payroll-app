import{r as l,j as e,L as b}from"./app-yxEi3xJe.js";import{S as w,C as y,B as A,a as L,X as D,Y as E,b as F,c as Y,d as N,e as T,f as c,g as B}from"./scroll-area-BpRhE63i.js";import{S as h,a as f,b as x,c as j,d as p}from"./select-BnEmntSq.js";import{A as I}from"./app-layout-BmWLcPuv.js";import"./app-logo-icon-CXNx6eOd.js";import"./index-BcpDV_59.js";function R({attendances:i}){var m;const u=l.useMemo(()=>{const s=new Map;return i.forEach(r=>{s.set(r.user.id,r.user)}),Array.from(s.values()).sort((r,a)=>r.name.localeCompare(a.name))},[i]),d=l.useMemo(()=>{const s=new Set;return i.forEach(r=>{s.add(new Date(r.date).getFullYear())}),Array.from(s).sort((r,a)=>a-r)},[i]),[o,v]=l.useState(()=>{const s=new Date().getFullYear();return d.includes(s)?s:d[0]||s}),[n,g]=l.useState(((m=u[0])==null?void 0:m.id)||""),k=l.useMemo(()=>{const s=Array.from({length:12},(a,t)=>({month:new Date(o,t).toLocaleString("id-ID",{month:"long"}),finished:0,overtime:0,leave:0,sick:0}));return i.filter(a=>{const t=new Date(a.date).getFullYear();return a.user.id===n&&t===o}).forEach(a=>{const t=new Date(a.date).getMonth();if(a.status==="finished"){if(s[t].finished+=1,a.clock_in&&a.clock_out){const S=new Date(`${a.date}T${a.clock_in}`);(new Date(`${a.date}T${a.clock_out}`).getTime()-S.getTime())/(1e3*60*60)>8.5&&(s[t].overtime+=1)}}else a.status==="leave"?s[t].leave+=1:a.status==="sick"&&(s[t].sick+=1)}),s},[n,o,i]),C={finished:{label:"Hadir",color:"#3B82F6"},overtime:{label:"Lembur",color:"#10B981"},leave:{label:"Libur Cuti",color:"#F43F5E"},sick:{label:"Libur Sakit",color:"#D946EF"}};return e.jsxs(I,{breadcrumbs:[{title:"Laporan Presensi",href:"/"}],children:[e.jsx(b,{title:"Laporan Presensi"}),e.jsxs("div",{className:"m-4 space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsx("div",{className:"w-full md:w-auto",children:e.jsxs(h,{value:n,onValueChange:g,children:[e.jsx(f,{children:e.jsx(x,{})}),e.jsx(j,{children:u.map(s=>e.jsx(p,{value:s.id,children:s.name},s.id))})]})}),e.jsx("div",{className:"w-full md:w-auto",children:e.jsxs(h,{value:String(o),onValueChange:s=>v(Number(s)),children:[e.jsx(f,{children:e.jsx(x,{})}),e.jsx(j,{children:d.map(s=>e.jsx(p,{value:String(s),children:s},s))})]})})]}),n&&e.jsxs(w,{className:"pb-4",children:[e.jsx(y,{config:C,className:"min-h-[74vh] sm:min-h-auto",children:e.jsxs(A,{data:k,children:[e.jsx(L,{vertical:!1,strokeDasharray:"5 5"}),e.jsx(D,{dataKey:"month",axisLine:!1,tickFormatter:s=>s.slice(0,3)}),e.jsx(E,{axisLine:!1,tickCount:7,tickFormatter:s=>`${s} hari`,padding:{top:20}}),e.jsx(F,{content:e.jsx(Y,{})}),e.jsx(N,{content:e.jsx(T,{})}),e.jsx(c,{dataKey:"finished",fill:"var(--color-finished)",radius:[8,8,0,0]}),e.jsx(c,{dataKey:"overtime",fill:"var(--color-overtime)",radius:[8,8,0,0]}),e.jsx(c,{dataKey:"leave",fill:"var(--color-leave)",radius:[8,8,0,0]}),e.jsx(c,{dataKey:"sick",fill:"var(--color-sick)",radius:[8,8,0,0]})]})}),e.jsx(B,{orientation:"horizontal"})]})]})]})}export{R as default};
